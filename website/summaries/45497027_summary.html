<article>
    <h2>RediShell: Critical remote code execution vulnerability in Redis</h2>
    <div>
<div>
  <h2>Summary</h2>
  <p>
    Wiz Research has identified a Remote Code Execution (RCE) vulnerability in Redis, tracked as CVE-2024-49844. This vulnerability affects Redis versions 7.4 and earlier, stemming from weaknesses in the Lua scripting engine and the `cjson` library. Exploitation allows attackers to execute arbitrary code on servers running vulnerable Redis instances. The vulnerability specifically involves the ability to bypass the Lua sandbox environment within Redis, leading to arbitrary code execution by manipulating the `cjson` library's handling of numbers. Redis is a popular in-memory data structure store, often used as a database, cache, message broker, and streaming engine, making this vulnerability a significant risk for many organizations.
  </p>
  <p>
    The vulnerability arises because the `cjson` library, integrated into Redis for handling JSON, can be manipulated through Lua scripts to misinterpret certain floating-point numbers. This misinterpretation leads to an out-of-bounds write, allowing attackers to overwrite memory and ultimately execute arbitrary code. The vulnerability is triggered through a specific sequence of Lua script operations interacting with `cjson.decode` with specially crafted JSON payloads containing large numbers that exploit the type confusion.
  </p>
  <p>
    Successful exploitation requires the attacker to have the ability to execute Lua scripts on the Redis server. While direct access to Lua scripting is often restricted in production environments, vulnerabilities like authentication bypasses or command injection can provide attackers with the necessary privileges. This vulnerability is particularly concerning in cloud environments where Redis instances might be exposed or misconfigured.
  </p>
  <p>
    Wiz Research demonstrated a full RCE exploit, highlighting the potential for complete system compromise. The Wiz team recommends immediate patching of Redis instances to version 7.4.1 or later. If patching is not immediately feasible, they suggest implementing mitigation strategies such as disabling Lua scripting or restricting access to Redis instances from untrusted networks. Redis Labs has released patched versions of Redis to address this vulnerability. Organizations are urged to assess their Redis deployments, prioritize patching, and implement appropriate security measures to prevent exploitation.
  </p>

  <h2>Key Points</h2>
  <ul>
    <li><strong>Vulnerability:</strong> Remote Code Execution (RCE) in Redis, tracked as CVE-2024-49844.</li>
    <li><strong>Affected Versions:</strong> Redis versions 7.4 and earlier.</li>
    <li><strong>Root Cause:</strong> Weaknesses in the Lua scripting engine and the `cjson` library's handling of numbers within Redis.</li>
    <li><strong>Exploitation Method:</strong> Bypassing the Lua sandbox to trigger arbitrary code execution through manipulated JSON payloads that cause type confusion in the `cjson` library.</li>
    <li><strong>Impact:</strong> Allows attackers to execute arbitrary code on the server running the vulnerable Redis instance, potentially leading to complete system compromise.</li>
    <li><strong>Prerequisites:</strong> Requires the ability to execute Lua scripts on the Redis server (often achieved through vulnerabilities like authentication bypass or command injection).</li>
    <li><strong>Mitigation:</strong> Upgrade Redis to version 7.4.1 or later. Disable Lua scripting or restrict access to Redis instances if patching is not immediately possible.</li>
    <li><strong>Researcher:</strong> Discovered by Wiz Research.</li>
    <li><strong>Vendor Response:</strong> Redis Labs has released patched versions of Redis.</li>
    <li><strong>Severity:</strong> High-severity vulnerability due to the potential for full RCE.</li>
  </ul>
</div>
</div>
</article>
